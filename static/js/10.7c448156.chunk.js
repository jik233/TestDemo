(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{469:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n(67),o=n(33),i=n(69),l=n(68),r=n(70),d=n(0),c=n.n(d),s=n(242),u=n(461),h=n(462);var m,f,p={originalLoader:m=new h.a,load:function(e){return new Promise(function(t,n){m.load(e,t,f,n)})}},g=[{id:null,url:"./gltf/isolateBlock/effect.glb",children:[{id:"start_box",name:"start_box"},{id:"end_box",name:"end_box"},{id:"start_fly",name:"start_fly"}]},{id:"ground_0",url:"./gltf/isolateBlock/ground_0.glb"},{id:null,url:"./gltf/isolateBlock/higher_block.glb",children:[{id:"higher_block_1",name:"1"},{id:"higher_block_2",name:"2"}]},{id:"highground_0",url:"./gltf/isolateBlock/highground_0.glb"},{id:"fire",url:"./gltf/isolateBlock/fire.glb"},{id:"tel_louti",url:"./gltf/isolateBlock/tel_louti.glb"}],b={map:[[2,2,2,2,2,2,2,2,2,2],[3,6,6,6,6,6,7,7,7,2],[2,1,6,6,6,6,6,6,7,2],[0,1,6,7,6,6,6,6,5,4],[3,6,6,7,2,2,6,5,5,4],[2,2,2,2,2,2,7,7,7,2],[2,2,2,2,2,2,2,2,2,2]],tileList:["tile_flystart","tile_fence","tile_forbidden","tile_start","tile_end","tile_volcano","tile_road","tile_wall"],heightMap:[[1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,1,1,1,1],[1,0,0,0,0,0,0,0,1,1],[1,0,0,1,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0],[1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1]],buildAbleMap:[[0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,2,2,2,0],[0,1,1,1,1,1,1,1,2,0],[0,1,1,2,1,1,1,1,1,0],[0,1,1,2,0,0,1,1,1,0],[0,0,0,0,0,0,2,2,2,0],[0,0,0,0,0,0,0,0,0,0]]};b.row=b.map.length,b.column=b.map[0].length;var w={x:1,y:1,z:1/3},_=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(l.a)(t).call(this,e))).sceneSetup=function(){var e=n.el.clientWidth,t=n.el.clientHeight;n.scene=new s.vb,n.camera=new s.kb(75,e/t,.1,1e3),n.camera.position.z=10,n.controls=new u.a(n.camera,n.el),n.controls.enablePan=!1,n.controls.maxDistance=10,n.controls.minDistance=5,n.renderer=new s.Qb,n.renderer.shadowMap.enabled=!0,n.renderer.shadowMap.type=s.jb,n.renderer.setSize(e,t),n.el.appendChild(n.renderer.domElement)},n.addCustomSceneObjects=function(){var e=new s.g(w.x,w.y,w.z),t=new s.T({wireframe:!0});new s.S(e,t);n.myMap=[],n.tile=[];var a=b.row*w.y/2,o=b.column*w.x/2;b.heightMap.forEach(function(e,t){n.tile[t]=[],e.forEach(function(e,i){if(e<0)n.tile[t].push(null);else{if("tile_start"===b.tileList[b.map[t][i]]){var l=n.loaded.start_box.clone();l.applyMatrix((new s.R).makeTranslation(i-o+.5,t-a+.5,0)),n.scene.add(l)}if("tile_end"===b.tileList[b.map[t][i]]){var r=n.loaded.end_box.clone();r.applyMatrix((new s.R).makeTranslation(i-o+.5,t-a+.5,0)),n.scene.add(r)}if("tile_flystart"===b.tileList[b.map[t][i]]){var d=n.loaded.start_fly.clone();d.applyMatrix((new s.R).makeTranslation(i-o+.5,t-a+.5,0)),n.scene.add(d)}if("tile_volcano"===b.tileList[b.map[t][i]]){var c=n.loaded.fire.clone();return c.applyMatrix((new s.R).makeTranslation(i-o+.5,t-a+.5,0)),n.scene.add(c),void n.tile[t].push(c)}if(0===e){var u=n.loaded.ground_0.clone();u.applyMatrix((new s.R).makeTranslation(i-o+.5,t-a+.5,0)),n.scene.add(u),n.tile[t].push(u)}if(1===e){if("tile_forbidden"===b.tileList[b.map[t][i]]){var h=n.loaded.higher_block_1.clone();return h.applyMatrix((new s.R).makeTranslation(i-o+.5,t-a+.5,0)),n.scene.add(h),void n.tile[t].push(h)}var m=n.loaded.highground_0.clone();m.applyMatrix((new s.R).makeTranslation(i-o+.5,t-a+.5,0)),n.scene.add(m),n.tile[t].push(m)}}})}),console.log(n.tile),n.myMap.forEach(function(e){return n.scene.add(e)});var i=[];i[0]=new s.w(16777215,526368,1),i[1]=new s.m(16777215,10),i[0].position.set(0,0,10),i[0].lookAt(0,0,0),i[1].position.set(5,5,5),i[1].castShadow=!0,i[1].lookAt(0,0,0),n.scene.add(i[0]),n.scene.add(i[1])},n.startAnimationLoop=function(){n.renderer.render(n.scene,n.camera),n.requestID=window.requestAnimationFrame(n.startAnimationLoop)},n.handleWindowResize=function(){var e=n.el.clientWidth,t=n.el.clientHeight;n.renderer.setSize(e,t),n.camera.aspect=e/t,n.camera.updateProjectionMatrix()},n.state={loaded:!1},n.loaded={},n.height=.5*window.screen.height,n.promiseLoadList=n.allGltfLorder(),n}return Object(r.a)(t,e),Object(o.a)(t,[{key:"allGltfLorder",value:function(){var e=this,t=[];return g.forEach(function(n){var a=p.load(n.url).then(function(t){console.log(t),n.id?e.loaded[n.id]=t.scene:n.children&&n.children.length>0&&n.children.forEach(function(n){e.loaded[n.id]=t.scene.getObjectByName(n.name)})}).catch(function(e){return console.log(e)});t.push(a)}),t}},{key:"componentDidMount",value:function(){var e=this;Promise.all(this.promiseLoadList).then(function(){for(var t in e.sceneSetup(),e.loaded){var n=e.loaded[t],a=new s.R,o=new s.f;n.children.forEach(function(e){e.castShadow=!0,e.receiveShadow=!0}),n.castShadow=!0,n.receiveShadow=!0,a.makeRotationX(Math.PI/2),n.applyMatrix(a),o.setFromObject(n);var i=new s.Mb;o.getSize(i);var l=new s.Mb;if(i.x/i.y<.8||i.y/i.x<.8){var r=i.x<i.y?i.x:i.y;l.set(1/r,1/r,1/r)}else l.set(1/i.x,1/i.y,1/Math.sqrt(i.x*i.y));a.makeScale(l.x,l.y,l.z),n.applyMatrix(a)}var d=new s.f;d.setFromObject(e.loaded.ground_0),e.loaded.ground_0.position.z=-d.max.z;var c=new s.f;c.setFromObject(e.loaded.highground_0),e.loaded.highground_0.position.z=-c.min.z-d.getSize().z,c.setFromObject(e.loaded.higher_block_1),e.loaded.higher_block_1.position.z=-c.min.z,c.setFromObject(e.loaded.higher_block_2),e.loaded.higher_block_2.position.z=-c.min.z-d.getSize().z;var u=new s.f;u.setFromObject(e.loaded.end_box),["end_box","start_box","start_fly"].forEach(function(t){e.loaded[t].position.z=-u.min.z,e.loaded[t].castShadow=!1,e.loaded[t].material.metalness=.8,e.loaded[t].material.roughness=0,e.loaded[t].material.opacity=.75,e.loaded[t].material.alphaTest=.2}),["fire","tel_louti"].forEach(function(t){c.setFromObject(e.loaded[t]),e.loaded[t].position.z=-c.max.z}),e.addCustomSceneObjects(),e.startAnimationLoop(),window.addEventListener("resize",e.handleWindowResize)}).catch(function(e){return console.log(e)})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),window.cancelAnimationFrame(this.requestID),this.controls.dispose()}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{style:{height:"".concat(this.height,"px")},ref:function(t){return e.el=t}})}}]),t}(d.Component),v=function(e){function t(){var e,n;Object(a.a)(this,t);for(var o=arguments.length,r=new Array(o),d=0;d<o;d++)r[d]=arguments[d];return(n=Object(i.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={isMounted:!0},n}return Object(r.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.state.isMounted,n=void 0===t||t;return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{onClick:function(){return e.setState(function(e){return{isMounted:!e.isMounted}})}},n?"Unmount":"Mount"),n&&c.a.createElement(_,null),n&&c.a.createElement("div",null,"Scroll to zoom, drag to rotate"))}}]),t}(c.a.Component)}}]);